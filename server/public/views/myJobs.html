<div ng-include="'/views/templates/nav.html'"></div>
<md-card class="myJobsCard">
  <md-toolbar>
    <h1 class="toolbarText">My Jobs</h1>
  </md-toolbar>
  <div>
    <md-card ng-repeat="job in userJobs">

      <div ng-click="setActive(job)">
      <div class="userJobListRepeatJobs">

      <div>
        <p>Address: <strong>{{job.address.line1}} </strong></p>
        <p><strong>{{job.address.city}}, {{job.address.state}}  {{job.address.zip}}</strong></p>
      </div>
      <div>
        <p>Primary Email: <strong>{{job.emails[0]}}</strong></p>
        <p>Phone: <strong>{{job.phone}}</strong></p>
      </div>

      <div>
        <p>Square Feet: <strong>{{job.squareFeet.name}} - ${{job.squareFeet.value}}</strong></p>
        <p>After Dark: <strong>{{job.afterDark.name}} - ${{job.afterDark.value}}</strong></p>
        <p>Job Status: <strong>{{job.jobStatus}}</strong></p>
      </div>
      <div>
        <p>Preferred Date: <strong>{{job.preferredDate | date : format : longDate}}</strong></p>
        <p>TimeFrame: <strong>{{job.timeFrame}}</strong></p>
        <p>Pay: <strong>${{job.totalPrice}}</strong></p>
      </div>
      </div>

      <div class="showmeButtons">

          <md-button class="md-raised md-primary showMeTrue" ng-click="showMe=!showMe">show/hide</md-button>
      </div>

<!-- ***************************** CHAT BOX **************************************** -->
      <div ng-show="showMe" class="chatCard">
        <md-card>
          <div class="chatFeatures">

            <h3>Homeowner Chat</h3>

            <div class="chatBox">
                <p class="chatLine" ng-repeat="message in messages">
              On {{message.timestamp | date:'short'}} {{message.username}} said:  <strong> {{message.message}} </strong>
                 </p>
            </div>

            <div class="sendUserMessageDiv">
              <form>
                <md-input-container class="md-block messageTextArea">
                  <label>Message</label>
                  <textarea type="text" ng-model="messageContainer.message"></textarea>
                </md-input-container>
                  <md-button class="md-raised md-primary sendMessageUser" ng-click="submitMessage(job._id)" type="submit" name="sendUserMessage">Send</md-button>
                </form>
              </div>
            <!-- ************* SET TIME WITH HOMEOWNER *************** -->
            <div class="chatTimeSet">
              <form>
                <md-datepicker   ng-if="job.jobStatus != 'finished'" class="chatDatePicker md-block" ng-model="timeFrame.date" md-placeholder="Photoshoot Date">
                </md-datepicker>

                <md-input-container ng-if="job.jobStatus != 'finished'" class="chatTimePicker md-block">
                  <label>Preferred Time</label>
                  <md-select  ng-model="timeFrame.time" aria-label="Timeframe">
                    <md-option ng-repeat="item in preferredTime">{{item}}</md-option>
                  </md-select>
                </md-input-container>
                <md-button ng-if="job.jobStatus != 'finished'" class="md-raised md-primary md-block photoshootTimeSetButton" ng-click="submitDate(job._id)" type="submit" name="setTimeAndDate">Confirm</md-button>
              </form>

              <div ng-show="job.chat.date != ''">

                <p>CURRENTLY CONFIRMED</p>
                <p>{{job.chat.date | date : format : longDate}}</p>
                <p>{{job.chat.time}}</p>
                <p>Method of Entry: {{job.entryMethod}}</p>
                <p ng-if="job.photoURL != ''">CURRENT PHOTO LINK: {{job.photoURL}}</p>
                <label for="photos">Drop Photo Link Here</label>
                <input ng-model="photoURL.url" type="text" name="photos" />
                <md-button class="md-raised md-primary md-block" ng-click="submitPhotoURL(job._id)">Submit Photos</md-button>
              </div>

            </div>

              <!-- ******************************************** -->
            <div class="sendUserMessageDiv" ng-if="job.jobStatus != 'finished'">
              <form>
                <md-input-container class="md-block messageTextArea">
                  <label>Send Message</label>
                  <textarea type="text" ng-model="messageContainer.message"></textarea>
                </md-input-container>
                  <md-button class="md-raised md-primary sendMessageUser" ng-click="submitMessage(job._id)" type="submit" name="sendUserMessage">Send</md-button>
                </form>

              </div>
              <!-- ******************************************** -->

          </div>


        </md-card>
      </div>
      <!-- ********************************************************************* -->
    </md-card>
  </div>



</md-card>
